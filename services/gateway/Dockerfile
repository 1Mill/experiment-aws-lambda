FROM node:14-alpine

RUN apk update

WORKDIR /app

COPY package.json package-lock.json ./
RUN npm install

ENV \
	AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID} \
	AWS_DEFAULT_REGION=${AWS_DEFAULT_REGION} \
	AWS_LAMBDA_ARN=${AWS_LAMBDA_ARN} \
	AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY} \
	CLOUDEVENTS_RAPIDS_PROTOCAL=${CLOUDEVENTS_RAPIDS_PROTOCAL} \
	CLOUDEVENTS_RAPIDS_URLS=${CLOUDEVENTS_RAPIDS_URLS}

COPY . .

CMD [ "npm", "run", "start" ]
